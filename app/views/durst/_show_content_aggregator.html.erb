<div class="row" id="child_items">

	<div id="item-description" class="col-md-3">
		<div class="inner noprint-sm" style="margin-bottom:1em;">
			<script>

				<% latlong = document['geo'].present? ? document['geo'][0].split(',') : ['40.7400', '-73.9802'] %>

				DCV.centerLat = <%= latlong[0] %>;
				DCV.centerLong = <%= latlong[1] %>;
				DCV.mapPlanes = <%= extract_map_data_from_document_list([document]).to_json.html_safe %>;
				DCV.mapCoordinateSearchUrl = decodeURIComponent('<%= CGI.escape(url_for(params.except(:'utf8').merge(:lat => '_lat_', :long => '_long_', :search_field => params[:search_field] || 'all_text_teim', :q => params[:q] || ''))).html_safe %>');
			</script>
			<div id="durst_osm" class="no-popup"></div>
			<div class="clearfix"></div>
		</div>
		<div class="inner" style="margin-bottom:1em;padding-bottom:0;">
			<% geo_facet_fields_to_show = {'subject_hierarchical_geographic_neighborhood_ssim' => 'Neighborhood', 'subject_hierarchical_geographic_borough_ssim' => 'Borough', 'subject_hierarchical_geographic_city_ssim' => 'City'} %>
			<% geo_non_facet_fields_to_show = {'subject_hierarchical_geographic_street_ssim' => 'Address', 'geo' => 'Coordinates'} %>
			<dl class="dl-vertical">
				<% geo_facet_fields_to_show.each do |field_name, display_label|  %>
					<% if document[field_name].present? %>
						<dt><%= display_label %></dt>
						<dd><ul><%= document[field_name].uniq.map{|val| ('<li><a href="' + durst_facet_search_url(field_name, val) + '">' + val + '</a></li>').html_safe}.join('').html_safe %></ul></dd>
					<% end %>
				<% end %>
				<% geo_non_facet_fields_to_show.each do |field_name, display_label|  %>
					<% if document[field_name].present? %>
						<dt><%= display_label %></dt>
						<dd><ul><%= document[field_name].uniq.map{|val| "<li#{(field_name == 'geo' ? ' class="coordinates"' : '')}>#{val}</li>" }.join('').html_safe %></ul></dd>
					<% end %>
				<% end %>
			</dl>
		</div>
    <div class="inner noprint-sm">
      <%= link_to '<span class="glyphicon glyphicon-file"></span> Display XML Metadata'.html_safe, item_mods_path(:pid => @document.id), :'data-no-turbolink' => true, :'data-display-url' => item_mods_path(:pid => @document.id, :type => 'formatted_text'), :'data-download-url' => item_mods_path(:pid => @document.id, :type => 'download'), :onclick => 'return DCV.ModsDownloadModal.show($(this).attr("data-display-url"), $(this).attr("data-download-url"));' %>
    </div>
  </div>

	<% is_book = document['lib_format_ssm'].present? && document['lib_format_ssm'].include?('books') %>
	<% is_postcard = document['lib_format_ssm'].present? && document['lib_format_ssm'].include?('postcards') %>

	<div class="col-md-9">
		<div class="inner">
			<h3 id="doc-item-title" class="nomar">
				<%= '<span class="glyphicon glyphicon-book pull-left"></span> &nbsp;'.html_safe if is_book %>
				<%= document_show_html_title %>
			</h3>
		</div>

		<div id="item-content">
			<% if structured_children.present? %>
				<div class="inner" style="margin-top:1em;">
					<% if ct = structured_children.first %>
						<p id="ct"><%= ct[:title] %></p>
					<% end %>
					<div id="favorite-child">
					 <% if child = structured_children.first %>
						 <%= '<a href="#" class="next-child" onclick="return DCV.Show.FavoriteChildNavigation.previous(this);"><span class="glyphicon glyphicon-chevron-left"></span></a>'.html_safe if structured_children.length > 1 %>
						 <img itemprop="contentUrl" onclick="$('.item-cbox').click();" src="<%= get_resolved_asset_url(id: child[:id], size: 768, type: 'scaled', format: 'jpg') %>" data-counter="1" data-sequence="0" data-zoom-url="<%= details_path(id: document[:id], layout:(request.path.split('/')[1])) %>" data-info-url="<%= get_resolved_asset_info_url(id: structured_children.first[:id], image_format: 'jpg') %>" data-bytestreams="<%= resolve_catalog_bytestreams_path(catalog_id: structured_children.first[:id], :format=>'json') %>"/>
						 <%= '<a href="#" class="previous-child" onclick="return DCV.Show.FavoriteChildNavigation.next(this);"><span class="glyphicon glyphicon-chevron-right"></span></a>'.html_safe if structured_children.length > 1 %>
					 <% end %>
					</div>
					<%= render_document_partials @document, (document['dc_type_ssm'].present? && document['dc_type_ssm'].include?('FileSystem') ? @document['dc_type_ssm'].collect{|x| x.underscore} : ['gallery']) %>
				</div>
			<% end %>

			<div class="inner" style="margin-top:1em;">
				<dl class="dl-horizontal">
					<% document_show_fields(document).each do |solr_fname, field| %>
						<% if solr_fname.to_s == 'dynamically_generated_published_field' %>
							<% publisher_field_value = combined_field_published_string(document) %>
							<% if publisher_field_value.present? %>
								<dt><%= render_document_show_field_label document, :field => solr_fname %></dt>
								<dd><%= publisher_field_value %></dd>
							<% end %>
						<% elsif should_render_show_field?(document, field) %>
							<dt class="blacklight-<%= solr_fname.parameterize %>"><%= render_document_show_field_label document, :field => solr_fname %></dt>
							<dd class="blacklight-<%= solr_fname.parameterize %>"><%= render_document_show_field_value document, :field => solr_fname %></dd>
						<% end %>
					<% end %>
				</dl>
				<%= render_url_and_catalog_links(document) %>
				<%= render_durst_location_information(document) if is_postcard %>
			</div>

		</div>
	</div>

</div>
